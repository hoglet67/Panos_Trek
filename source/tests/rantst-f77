      PROGRAM RANTST
C
      ISEED=111
      CALL RANSET(ISEED)
      KOUNT=1
      DO 210 J=1,20
      DO 200 I=1,20
      RRANF=RANF(0)
      WRITE (*,100,ERR=900) KOUNT,ISEED,RRANF
 100  FORMAT (I5,3X,I5,3X,F10.6)
      KOUNT=KOUNT+1
 200  CONTINUE
      KOUNT=1
      ISEED=ISEED+123
      CALL RANSET(ISEED)
 210  CONTINUE
 900  CALL EXIT
      END
C
      REAL FUNCTION RANF(IDUMMY)
C
C     25-APR-79
C     CHANGED TO USE THE ONE-ARGUMENT VERSION OF THE RAN FUNCTION,
C     AND TO USE AN INTEGER*4 SEED.
C
C     INTEGER*4 IRAN,ISEED
      INTEGER IRAN,ISEED
      INTEGER BINTIME(0:1)
C*
      IRAN=IFXRANDOM()
      IF (IRAN.GT.0) GO TO 10
      IRAN=-IRAN
 10   RANF=IRAN/2147483648.0
      RETURN
C*
      ENTRY RANSET(ISEED)
C*
      IF (ISEED.NE.0) GO TO 20
      CALL IFXBINARYTIME(BINTIME)
      ISEED=BINTIME(0)
 20   CALL IFXSETRANDOMSEED(ISEED)
      RETURN
      END
